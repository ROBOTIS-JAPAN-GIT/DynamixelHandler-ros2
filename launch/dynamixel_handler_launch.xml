<launch>

    <set_env name="RCUTILS_CONSOLE_OUTPUT_FORMAT" value="{function_name}(): {message} "/>
    <set_env name="RCUTILS_COLORIZED_OUTPUT" value="1"/>
    
    <!-- 変数 -->
    <arg name="name_space" default="ns"/> <!-- config/{}.yaml内のnamespaceとそろえる必要あり -->
    <arg name="name_pkg" default="dynamixel_handler"/>

    <!-- 通信設定 -->
    <arg name="baudrate" default="57200"/>
    <arg name="device_name" default="/dev/ttyUSB0"/>
    <arg name="latency_timer" default="16"/>

    <node pkg="$(var name_pkg)" exec="dynamixel_handler_node" name="dyn_handler" namespace="$(var name_space)" output="screen">
        <!-- 通信の設定 -->
        <param name="baudrate" value="$(var baudrate)"/>
        <param name="device_name" value="$(var device_name)"/>
        <param name="latency_timer" value="$(var latency_timer)"/>

        <!-- 細かいパラメータの設定 -->
        <param from="$(find-pkg-share $(var name_pkg))/config/config_dynamixel_handler.yaml"/>

        <!-- トピックの設定 -->
        <!-- 書き込み -->
        <remap from="dynamixel/commnads/x"   to="dynamixel/commnads"/>
        <remap from="dynamixel/command/x/pwm"                   to="dynamixel/command/pwm"/>
        <remap from="dynamixel/command/x/current"               to="dynamixel/command/current"/>
        <remap from="dynamixel/command/x/velocity"              to="dynamixel/command/velocity"/>
        <remap from="dynamixel/command/x/position"              to="dynamixel/command/position"/>
        <remap from="dynamixel/command/x/extended_position"     to="dynamixel/command/extended_position"/>
        <remap from="dynamixel/command/x/current_base_position" to="dynamixel/command/current_position"/>
        <remap from="dynamixel/command/status" to="dynamixel/command/status"/>
        <remap from="dynamixel/command/goal"   to="dynamixel/command/goal"/>
        <remap from="dynamixel/command/gain"   to="dynamixel/command/gain"/>
        <remap from="dynamixel/command/limit"  to="dynamixel/command/limit"/>
        <remap from="dynamixel/command/extra"  to="dynamixel/command/extra"/>

        <!-- 読み込み -->
        <remap from="dynamixel/states" to="dynamixel/states"/>
        <remap from="dynamixel/state/status"  to="dynamixel/status"/>
        <remap from="dynamixel/state/present" to="dynamixel/present"/>
        <remap from="dynamixel/state/goal"    to="dynamixel/goal" />
        <remap from="dynamixel/state/gain"    to="dynamixel/gain" />
        <remap from="dynamixel/state/limit"   to="dynamixel/limit"/>
        <remap from="dynamixel/state/error"   to="dynamixel/error"/>
        <remap from="dynamixel/state/extra"   to="dynamixel/extra"/>
    </node>

</launch>